\clearpage
# Figures

```{r}
library(here)
library(float)
fig_dir1 <- here::here("doc", "FinalFigs", "Intro")
fig_dir2 <- here::here("doc", "FinalFigs", "Data")
fig_dir3 <- here::here("doc", "FinalFigs", "Base")
fig_dir4 <- here::here("doc", "FinalFigs", "Sensitivities")
fig_dir5 <- here::here("doc", "FinalFigs", "Retros")

#Insert figure 
#Figure \ref{fig:label}
```

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.pos = 'H')
```


```{r, results = "asis"}
#add_figure_ling(csv=figurecsv, "data_plot$")
```


## Data figures

```{r, catch-figures, results = "asis"}
# Example function for how to arrange figures in order of the time they were modified--from lingcod asssessment--find that function

# add_figure_ling(dplyr::bind_rows(mapply(
#   FUN = utils::read.csv,
#   file = dir(file.path("..","figures"), pattern = "^catch-.+\\.csv",full.names=TRUE),
#   SIMPLIFY = FALSE
# )) %>% dplyr::arrange(file.info(filein)$mtime)
# )
```


```{r,  results = "asis"}
#Figure 1 Coastwide CPUE plot from NWFSC combo survey
sa4ss::add_figure(filein = file.path(fig_dir1, "stock-map.png "), 
                  caption = "Biomass of shortspine thornyhead found in the NWFSC West Coast Groundfish Bottom Trawl Survey annual survey (2003-2022) coastwide.", 
                  label = "stock-map")

# Figure 2 Unid thornyheads and proportion shortspine
sa4ss::add_figure(filein = file.path(fig_dir1, "thornyhead-ratio.png "), 
                  caption = "Unidentified thornyhead catches (mt) and the proportion identified as shortspines, calculated as the ratio of shortspine thornyhead catches to combined longspine and shortspine catches.", 
                  label = "thornyhead-ratio")

# Add a page break
cat("\n\\newpage\n\n")
```

\clearpage

```{r,  results = "asis"}
# Figure 3 Catch history
sa4ss::add_figure(filein = file.path(fig_dir3, "catch2 landings stacked.png"), 
                  caption = "Estimated landing history for shortspine thornyhead.", 
                  label = "catch_hist")
```

\newpage

```{r,  results = "asis"}
#These figures come out of both the data folder and the model folder

# Figure 4 Data Sources Figure
sa4ss::add_figure(filein = file.path(fig_dir2, "assessment_data_timeseries.png"), 
                  caption = "Summary of data sources used in the base model.", 
                  label = "assessment_data_timeseries")


#Figure 5 Discard history
sa4ss::add_figure(filein = file.path(fig_dir3, "catch7 discards stacked plot (depends on multiple fleets).png"), 
                  caption = "Predicted discards based estimated retention and selectivity for each fleet.", 
                  label = "disc_hist")

#Discard Rates 
sa4ss::add_figure(filein = file.path(fig_dir2, "SST_WCGOP_GEMM_discard_rates_3fleet.png"), 
                  caption = "Discard rates from the WCGOP data set with catch share and non-catch share considerations from the GEMM dataset.", 
                  label = "disc_rates_WCGOP")

# Add a page break
cat("\n\\newpage\n\n")

#Survey Data Sources 
sa4ss::add_figure(filein = file.path(fig_dir2, "survey_data_timeseries.png"), 
                  caption = "Summary of survey data sources used in the base model.", 
                  label = "survey_data_timeseries")

#Survey Length Comps 
sa4ss::add_figure(filein = file.path(fig_dir2, "2023_length_compositions.png"), 
                  caption = "Survey length composition data.", 
                  label = "survey_comps")

#Growth Curve LAA1
sa4ss::add_figure(filein = file.path(fig_dir2, "growth_curve_comparison_LAA1.png"), 
                  caption = "Growth curve comparison. ", 
                  label = "growth_LAA1")
#Growth Curve LAA1
sa4ss::add_figure(filein = file.path(fig_dir2, "growth_curve_sensitivities_LAA2.png"), 
                  caption = "Growth curve sensitivities", 
                  label = "growth_LAA2")

#Maturity 1
sa4ss::add_figure(filein = file.path(fig_dir2, "head2023_maturity_latdepth_glm_fit.png"), 
                  caption = "Fit of the maturity curves per size and depth classes. Classes are designed for visual check of the model predictions only since the model assumes continuous and not categorical response to these variables.", 
                  label = "mat1")

#Maturity 2
sa4ss::add_figure(filein = file.path(fig_dir2, "comparison_alternative_maturity_curves.png"), 
                  caption = "Maturity curves considered in the present assessment (Head (2023)) and alternative versions considered in the sensitivity analysis.", 
                  label = "mat2")

```

```{r,  results = "asis"}

#Senitivity Plots 

#Growth

sa4ss::add_figure(filein = file.path(fig_dir4, "Growth", "mngmttarget-1.png"), 
                  caption = "Relative spawning output comparisons of the base model and high growth and low growth assumptions.", 
                  label = "growth_sensitiv_mngmt")

sa4ss::add_figure(filein = file.path(fig_dir4, "Growth", "spawningoutput-1.png"), 
                  caption = "Spawning output comparisons of the base model and high growth and low growth assumptions.", 
                  label = "growth_sensitiv_spawning")


sa4ss::add_figure(filein = file.path(fig_dir4, "Growth", "index_combosurv-1.png"), 
                  caption = "Comparison of fits to combo survey data between the base model and high growth and low growth sensitivities.", 
                  label = "growth_sensitiv_indx")

#Maturity

sa4ss::add_figure(filein = file.path(fig_dir4, "Maturity", "mngmttarget-1.png"), 
                  caption = "Relative spawning output comparisons of the base model and maturity sensitivities.", 
                  label = "mat_sensitiv_mngmt")

#Landings 

sa4ss::add_figure(filein = file.path(fig_dir4, "Landings", "mngmttarget-1.png"), 
                  caption = "Relative spawning output comparisons of the base model and landing sensitivities.", 
                  label = "land_sensitiv_mngmt")
```

```{r, results = "asis"}

#Retrospectives

sa4ss::add_figure(filein = file.path(fig_dir5, "compare2_spawnbio_uncertainty.png"), 
                  caption = "Retrospectives showing impact on spawning output.", 
                  label = "retros_spawnbio")

sa4ss::add_figure(filein = file.path(fig_dir5, "compare4_Bratio_uncertainty.png"), 
                  caption = "Retrospectives showing impact on stock status.", 
                  label = "retros_bratio")

sa4ss::add_figure(filein = file.path(fig_dir5, "compare13_indices_flt6.png"), 
                  caption = "Retrospectives showing impact on fits to WCGBTS index.", 
                  label = "retros_indices")
```

```{r, results ='asis'}

#profiles 

```